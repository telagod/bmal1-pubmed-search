# 🎯 BMAL1文献检索系统 v3.1 - 最佳实践版

## 🆕 v3.1 重大改进

### 核心理念：数据本地化，不占用云端资源

**问题**：
- v3.0将数据存储在云端，重启后数据丢失
- 用户部署后看不到示例数据
- 不符合云端应用最佳实践

**解决方案**：
- ✅ 数据完全本地化管理
- ✅ 搜索后自动提示下载数据库
- ✅ 支持上传之前的数据库继续使用
- ✅ 不依赖云端持久化存储
- ✅ 深色模式UI

### 新增功能

1. **💾 数据管理页面**（首页）
   - 上传本地数据库文件
   - 查看数据库信息
   - 下载当前数据库
   - 清空临时数据

2. **🌙 深色模式**
   - 默认深色主题
   - 更适合长时间阅读

3. **📋 优化的配置流程**
   - 页面顺序调整
   - 更符合用户使用习惯

### 使用流程

#### 方式1：上传已有数据（推荐）

```
1. 进入"💾 数据管理"
2. 上传之前下载的数据库文件
3. 立即查看数据和分析结果
4. 可继续搜索添加新数据
5. 搜索后下载更新的数据库
```

#### 方式2：从头开始

```
1. 进入"⚙️ 设置"配置API
2. 进入"🔍 高级搜索"执行检索
3. 搜索完成后下载数据库文件
4. 下次访问时上传该文件继续使用
```

### 数据流程

```
搜索 → 数据存入临时数据库 → 下载到本地
     ↓
下次使用时上传 → 继续搜索 → 再次下载
```

**优势**：
- 云端零存储占用
- 用户完全控制自己的数据
- 可以在不同环境间迁移数据
- 符合云应用最佳实践

### 页面顺序（v3.1）

1. **💾 数据管理** - 首页，管理本地数据
2. **📊 Dashboard** - 数据概览
3. **🔍 高级搜索** - 执行检索
4. **📚 文献浏览** - 浏览和筛选
5. **📈 数据分析** - 深度分析
6. **⚙️ 设置** - API配置
7. **ℹ️ 关于** - 系统信息

### 技术改进

- 使用 `st.session_state` 管理临时数据库
- 使用 `tempfile` 创建临时文件
- 上传/下载通过内存传输，不落盘
- 应用重启后自动清理临时文件

### 兼容性

- 完全兼容v3.0的数据库格式
- 可以上传v2.0/v3.0创建的数据库
- 导出格式保持不变（JSON/MD/CSV）

---

## 升级指南

### 从v3.0升级

如果您已经部署了v3.0版本：

1. **备份数据**：
   - 如果有本地数据库，保存好
   - 导出重要的搜索结果

2. **更新代码**：
   ```bash
   git pull origin main
   ```

3. **重新部署**：
   - Streamlit Cloud会自动检测更新
   - 或手动触发重新部署

4. **上传数据**：
   - 进入新版应用的"数据管理"
   - 上传之前的数据库文件

### 新部署

直接按照 STREAMLIT_DEPLOY.md 部署即可。

---

## 最佳实践建议

### 对于个人用户

1. **定期备份**：
   - 每次搜索后下载数据库
   - 保存到本地安全位置
   - 建议使用云盘（OneDrive/Google Drive）同步

2. **数据管理**：
   - 为不同研究主题创建不同的数据库
   - 使用有意义的文件名（如 `bmal1_alzheimer_2025.db`）

3. **使用流程**：
   - 上传 → 搜索/浏览 → 下载
   - 不要依赖云端保存数据

### 对于团队使用

1. **共享数据库**：
   - 一人检索，导出数据库
   - 分享给团队成员
   - 成员上传后可以查看和分析

2. **分工协作**：
   - 不同成员检索不同主题
   - 合并多个数据库（本地SQLite操作）

3. **版本管理**：
   - 使用日期标记数据库版本
   - 保留重要版本的快照

---

**版本**: v3.1
**更新时间**: 2025-11-10
**作者**: KOOI Research Assistant ฅ'ω'ฅ

*数据在手，随心所用！* (✿◡‿◡)
